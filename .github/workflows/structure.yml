name: V√©rification de la structure du projet

on:
  pull_request:
    types: [opened, reopened, synchronize]

jobs:
  check-structure:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout du code
        uses: actions/checkout@v4

      - name: V√©rifier les fichiers et dossiers essentiels
        run: |
          MISSING=false

          echo "üîé V√©rification des fichiers racine..."
          for FILE in README.md CONTRIBUTING.md INSTALL.md LICENSE; do
            if [ ! -f "$FILE" ]; then
              echo "‚ùå Fichier manquant : $FILE"
              MISSING=true
            fi
          done

          echo "üîé V√©rification des dossiers MERN..."
          for DIR in frontend backend; do
            if [ ! -d "app/$DIR" ]; then
              echo "‚ùå Dossier manquant : $DIR"
              MISSING=true
            fi
          done

          echo "üîé V√©rification des fichiers internes du frontend..."
          if [ ! -f "app/frontend/package.json" ]; then
            echo "‚ùå app/frontend/package.json manquant"
            MISSING=true
          fi
          if [ ! -f "app/frontend/.env.example" ]; then
            echo "‚ùå app/frontend/.env.example manquant"
            MISSING=true
          fi

          echo "üîé V√©rification des fichiers internes du backend..."
          if [ ! -f "app/backend/package.json" ]; then
            echo "‚ùå app/backend/package.json manquant"
            MISSING=true
          fi
          if [ ! -f "app/backend/.env.example" ]; then
            echo "‚ùå app/backend/.env.example manquant"
            MISSING=true
          fi

          if [ "$MISSING" = true ]; then
            echo "üí° Corrigez les fichiers et dossiers manquants avant de merger la PR."
            exit 1
          else
            echo "‚úÖ Tous les fichiers et dossiers essentiels sont pr√©sents."
          fi
